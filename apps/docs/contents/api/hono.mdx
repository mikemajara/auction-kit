---
title: "Hono API Reference"
description: "REST API reference implementation with Hono framework"
order: 3
category: "api"
---

## Features

- **RESTful endpoints** for complete auction lifecycle
- **Cloudflare Workers** deployment ready
- **Node.js server** support
- **Consistent error handling** with `{ success, data?, error? }` format
- **CORS enabled** for cross-origin requests
- **Request logging** middleware
- **Type-safe** handlers using Drizzle queries

## Installation

```bash
pnpm add @auction-kit/hono hono
```

## Quick Start

### Node.js Server

```typescript
import { serve } from '@hono/node-server'
import app from '@auction-kit/hono'

serve({
  fetch: app.fetch,
  port: 3000,
})

console.log('Server running at http://localhost:3000')
```

### Cloudflare Workers

```typescript
import app from '@auction-kit/hono'

export default app
```

## API Endpoints

### Health Check

```
GET /health
```

Returns server health status.

**Response:**
```json
{ "status": "ok" }
```

---

### Auctions

#### List Auctions

```
GET /auctions
```

List all auctions with optional filtering.

**Query Parameters:**
- `status` (optional): Filter by status (`open`, `closed`, `resolved`)
- `limit` (optional): Maximum results to return
- `offset` (optional): Pagination offset

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": "uuid",
      "status": "open",
      "config": {
        "type": "second-price",
        "tieBreak": "timestamp",
        "multiUnit": false
      },
      "createdAt": "2024-01-01T00:00:00.000Z"
    }
  ]
}
```

#### Create Auction

```
POST /auctions
```

Create a new auction.

**Request Body:**
```json
{
  "type": "second-price",
  "tieBreak": "timestamp",
  "multiUnit": false
}
```

**Response (201):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "status": "open",
    "config": { ... },
    "createdAt": "2024-01-01T00:00:00.000Z"
  }
}
```

#### Get Auction State

```
GET /auctions/:id
```

Get complete auction state including bidders, items, bids, and settlements.

**Response:**
```json
{
  "success": true,
  "data": {
    "auction": { ... },
    "bidders": [ ... ],
    "items": [ ... ],
    "bids": [ ... ],
    "settlements": [ ... ]
  }
}
```

#### Update Auction

```
PATCH /auctions/:id
```

Update auction status (e.g., close bidding).

**Request Body:**
```json
{
  "status": "closed"
}
```

**Response:**
```json
{
  "success": true,
  "data": { ... }
}
```

---

### Bidders

#### Create Bidder

```
POST /auctions/:id/bidders
```

Add a new bidder to an auction.

**Request Body:**
```json
{
  "name": "Alice"
}
```

**Response (201):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "auctionId": "auction-uuid",
    "name": "Alice",
    "createdAt": "2024-01-01T00:00:00.000Z"
  }
}
```

#### List Bidders

```
GET /auctions/:id/bidders
```

List all bidders in an auction.

**Response:**
```json
{
  "success": true,
  "data": [ ... ]
}
```

#### Get Bidder

```
GET /bidders/:id
```

Get a single bidder by ID.

**Response:**
```json
{
  "success": true,
  "data": { ... }
}
```

#### Update Bidder

```
PATCH /bidders/:id
```

Update bidder information.

**Request Body:**
```json
{
  "name": "Alice Smith"
}
```

---

### Items

#### Create Item

```
POST /auctions/:id/items
```

Create a new item for an auction.

**Request Body:**
```json
{
  "name": "VIP Seat",
  "description": "Front row center seat",
  "quantity": 1
}
```

**Response (201):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "auctionId": "auction-uuid",
    "name": "VIP Seat",
    "description": "Front row center seat",
    "quantity": 1,
    "createdAt": "2024-01-01T00:00:00.000Z"
  }
}
```

#### List Items

```
GET /auctions/:id/items
```

List all items in an auction.

**Response:**
```json
{
  "success": true,
  "data": [ ... ]
}
```

#### Get Item

```
GET /items/:id
```

Get a single item by ID.

#### Update Item

```
PATCH /items/:id
```

Update item information.

**Request Body:**
```json
{
  "name": "Premium VIP Seat",
  "description": "Updated description",
  "quantity": 2
}
```

---

### Bids

#### Place Bid

```
POST /auctions/:id/bids
```

Place a bid on an item.

**Request Body:**
```json
{
  "bidderId": "bidder-uuid",
  "itemId": "item-uuid",
  "amount": 150
}
```

**Response (201):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "auctionId": "auction-uuid",
    "bidderId": "bidder-uuid",
    "itemId": "item-uuid",
    "amount": 150,
    "placedAt": "2024-01-01T00:00:00.000Z",
    "status": "active"
  }
}
```

#### List Bids

```
GET /auctions/:id/bids
```

List all bids in an auction.

**Response:**
```json
{
  "success": true,
  "data": [ ... ]
}
```

---

### Resolution

#### Resolve Auction

```
POST /auctions/:id/resolve
```

Resolve an auction and determine winners.

**Query Parameters:**
- `seed` (optional): Random seed for reproducible tie-breaking

**Response:**
```json
{
  "success": true,
  "data": {
    "settlements": [
      {
        "bidderId": "bidder-uuid",
        "itemId": "item-uuid",
        "wonAmount": 100,
        "bidAmount": 150
      }
    ],
    "errors": [],
    "resolvedAt": "2024-01-01T00:00:00.000Z"
  }
}
```

---

## Error Handling

All errors return a consistent format:

```json
{
  "success": false,
  "error": "Error message"
}
```

**HTTP Status Codes:**
- `200` - Success
- `201` - Created
- `400` - Bad request (validation error)
- `404` - Resource not found
- `409` - Conflict (e.g., updating resolved auction)
- `500` - Server error

---

## Usage Examples

### Complete Auction Flow

```bash
# 1. Create auction
curl -X POST http://localhost:3000/auctions \
  -H "Content-Type: application/json" \
  -d '{
    "type": "second-price",
    "tieBreak": "timestamp",
    "multiUnit": false
  }'

# 2. Create item
curl -X POST http://localhost:3000/auctions/{auctionId}/items \
  -H "Content-Type: application/json" \
  -d '{
    "name": "VIP Seat",
    "quantity": 1
  }'

# 3. Add bidders
curl -X POST http://localhost:3000/auctions/{auctionId}/bidders \
  -H "Content-Type: application/json" \
  -d '{ "name": "Alice" }'

curl -X POST http://localhost:3000/auctions/{auctionId}/bidders \
  -H "Content-Type: application/json" \
  -d '{ "name": "Bob" }'

# 4. Place bids
curl -X POST http://localhost:3000/auctions/{auctionId}/bids \
  -H "Content-Type: application/json" \
  -d '{
    "bidderId": "{aliceId}",
    "itemId": "{itemId}",
    "amount": 100
  }'

curl -X POST http://localhost:3000/auctions/{auctionId}/bids \
  -H "Content-Type: application/json" \
  -d '{
    "bidderId": "{bobId}",
    "itemId": "{itemId}",
    "amount": 150
  }'

# 5. Resolve auction
curl -X POST http://localhost:3000/auctions/{auctionId}/resolve

# Bob wins, pays $100 (second-price)!
```

---

## Development

```bash
# Run development server
pnpm dev

# Run tests
pnpm test

# Build
pnpm build

# Deploy to Cloudflare Workers
pnpm deploy
```

## Deployment

### Cloudflare Workers

1. Configure `wrangler.toml` with your database connection
2. Set environment variables:
   ```bash
   wrangler secret put DATABASE_URL
   ```
3. Deploy:
   ```bash
   pnpm deploy
   ```

### Node.js

1. Set `DATABASE_URL` environment variable
2. Run:
   ```bash
   node dist/server.js
   ```


